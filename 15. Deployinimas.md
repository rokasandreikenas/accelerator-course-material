---


---

<h2 id="deployinimas">15. Deployinimas</h2>
<p>Deployinimas yra svarbus etapas kuriant ir paleidžiant programas, leidžiantis vartotojams pasiekti jūsų sukurtą programą internetu. Heroku yra populiari platforma kaip paslauga (PaaS), leidžianti lengvai deployinti ir valdyti programas debesyje.</p>
<p>Prieš pradedant, įsitikinkite, kad turite šias sąlygas:</p>
<ul>
<li>Įdiegta Node.js ir npm.</li>
<li>Sukurtas ir paruoštas React projektas.</li>
<li>Įdiegta Heroku CLI.</li>
<li>Sukurta Heroku paskyra.</li>
</ul>
<h3 id="susikuriam-app-heroku-dashborde">1. Susikuriam app heroku dashborde</h3>
<p>Regioną renkamės kuris arčiau pagrindinių vartotojų, taip sumažinsime užkrovimo laiką.</p>
<p><a href="https://postimg.cc/JyXb1xRV"><img src="https://i.postimg.cc/Gp7zxgN2/Screenshot-2024-06-17-at-21-10-52.png" alt="Screenshot-2024-06-17-at-21-10-52.png"></a></p>
<p><a href="https://postimg.cc/BLG2tFv8"><img src="https://i.postimg.cc/V6JgGBQF/Screenshot-2024-06-17-at-21-11-15.png" alt="Screenshot-2024-06-17-at-21-11-15.png"></a></p>
<h3 id="prijungiam-githubo-repozitoriją">2. Prijungiam Githubo repozitoriją</h3>
<p><a href="https://postimg.cc/Th0nYpvw"><img src="https://i.postimg.cc/7Y8992Bg/Screenshot-2024-06-17-at-21-12-45.png" alt="Screenshot-2024-06-17-at-21-12-45.png"></a></p>
<h3 id="prisidedam-environment-variables">3. Prisidedam environment variables</h3>
<p><code>NPM_CONFIG_PRODUCTION</code> yra specialus variable kuris turi įtakos React aplikacijai. Šito variable dėka jis surašys devDependencies production metu, ko pasekoje <code>heroku</code> sugebės įrašyti reikiamus packagus.</p>
<p><a href="https://postimg.cc/5XL0yRQ3"><img src="https://i.postimg.cc/JzdB6w19/Screenshot-2024-06-17-at-21-26-25.png" alt="Screenshot-2024-06-17-at-21-26-25.png"></a></p>
<h3 id="nustatom-production-url">4. Nustatom production URL</h3>
<p><a href="https://postimg.cc/LJH7gqnb"><img src="https://i.postimg.cc/P5ZkcYhT/Screenshot-2024-06-17-at-21-34-52.png" alt="Screenshot-2024-06-17-at-21-34-52.png"></a></p>
<p>Turi atsidaryti URL naujam tab’e:<br>
<a href="https://home-service-app-heroku-e3f44bc25426.herokuapp.com/">https://home-service-app-heroku-e3f44bc25426.herokuapp.com/</a></p>
<p>Einate į savo front-end axios configą ir nustatote URL</p>
<pre><code>import { PROD } from "@/consts/environment";
import axios, { AxiosError, AxiosRequestConfig } from "axios";

const baseURL = PROD
? "https://home-service-app-heroku-e3f44bc25426.herokuapp.com/"
: "http://localhost:3000/";
</code></pre>
<p>Taip nurodydami <code>prod</code> aplikacija kreipsis į kitą URL, o lokalioje versijoje į localhost.</p>
<h3 id="atnaujinam-node.js-kodą">5. Atnaujinam Node.js kodą</h3>
<p>Pridedam dvi eilutes virš aplikacijos routų ir vieną po jais. Node.js aplikacija paims iš front-end buildo index.html failą ir panaudos kaip savo aplikacijos dalį. Taip pat pridedam <code>path</code> importą.</p>
<pre><code>app.use(express.json({ limit:  "50mb" }));
app.use(express.static(path.join(__dirname, "../../frontend/dist")));

app.use("/auth", authRoutes);
...
app.get("*", (req, res) =&gt; {
  res.sendFile(path.join(__dirname, "../../frontend/dist", "index.html"));
});
</code></pre>
<h3 id="pridedam-reikalingus-failus">6. Pridedam reikalingus failus</h3>
<p>Sukuriam du failus root kategorijoje:<br>
<code>Procfile</code> - heroku specialus failas, kuris paleis skriptus.<br>
<code>web: yarn start</code></p>
<p><code>package.json</code> - Node.js skriptų paleidimui</p>
<pre><code>{
  "name": "home-service-app",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "cd backend &amp;&amp; yarn &amp;&amp; yarn build &amp;&amp; yarn start",
    "heroku-postbuild": "cd frontend &amp;&amp; yarn &amp;&amp; yarn build",
    "deploy": "git push heroku main"
  },
  "engines": {
  "node": "20.x",
  "yarn": "1.x"
  },
 "keywords": [],
 "author": "",
 "license": "ISC"
}
</code></pre>
<blockquote>
<p>Pavyzdys: <a href="https://github.com/rokasandreikenas/home-service-app-heroku/pull/1/files">https://github.com/rokasandreikenas/home-service-app-heroku/pull/1/files</a></p>
</blockquote>
<h3 id="pakeičiam-duomenų-bazės-network-nustatymus">7. Pakeičiam duomenų bazės Network nustatymus</h3>
<p>Patalpinę savo kodą <code>heroku</code> serveriuose jie naudoja dinaminius IP, o ne statinius, todėl Mongo DB nustatymuose mes negalime taip paprastai įklijuoti dar vienos IP prieigos. Tam yra du sprendimo būdai:</p>
<ul>
<li>Naudoti proxy serverį, saugus variantas, bet brangus. <code>heroku</code> turi savo <code>Fixie Socks</code> proxy kuris lengvai integruojasi.</li>
<li>Leisti prisijungti bet kokiam IP prie DB, nesaugus, bet pigus. Svarbu daryti stiprius name ir password.</li>
</ul>
<p><a href="https://postimg.cc/N2QTk2ZK"><img src="https://i.postimg.cc/C5qNYjNs/Screenshot-2024-06-17-at-22-12-07.png" alt="Screenshot-2024-06-17-at-22-12-07.png"></a></p>
<h3 id="deploy">8. Deploy</h3>
<p>Viską stumiam į main branchą ir</p>
<ul>
<li>paleidžiam rankomis deploy iš <code>heroku</code> puslapio<br>
arba</li>
<li>nustatom <code>heroku</code> kaip repozitoriją su komanda <code>heroku git:remote -a home-service-app-heroku</code> bei paleidžiam <code>yarn deploy</code> skriptą.</li>
</ul>
<p><a href="https://postimg.cc/MM9ZgcvM"><img src="https://i.postimg.cc/sxrBQ7zc/Screenshot-2024-06-17-at-22-21-32.png" alt="Screenshot-2024-06-17-at-22-21-32.png"></a></p>
<p>Atidarom linką:</p>
<p><a href="https://postimg.cc/YLj27pWX"><img src="https://i.postimg.cc/NFkK1Ffw/Screenshot-2024-06-17-at-22-22-56.png" alt="Screenshot-2024-06-17-at-22-22-56.png"></a></p>

