---


---

<h2 id="react-context-ir-zustand">4. React Context ir zustand</h2>
<p><code>useContext</code> yra React hook, kuris leidžia komponentams tiesiogiai naudotis Context duomenimis, kurie yra pasiekiami per visą komponentų medį. Tai išvengia tėvinių komponentų ir vaikinių komponentų sąsajos sudėtingumo ir padeda išlaikyti kodo švarumą bei suprantamumą.</p>
<p><strong>Kaip veikia <code>useContext</code>:</strong></p>
<ul>
<li><strong>Sukuriamas Context:</strong> Pirmiausia reikia sukurti Context naudojant <code>createContext()</code>. Tai apibrėžia duomenis, kuriuos norite prieinamus padaryti visame aplikacijoje.</li>
<li><strong><code>Provider</code> komponentas:</strong> Context objektas turi <code>Provider</code> komponentą, kuris apibrėžia, koks value bus pateikiamas tiems, kurie naudos šį Context. <code>Provider</code> gali būti naudojamas bet kurioje vietoje komponentų medyje, ir visi komponentai, esantys šiame medyje, gali gauti prieigą prie Context duomenų. Dažniausiai būna top level App.jsx</li>
<li><strong>Naudojimas su <code>useContext</code>:</strong> Komponentuose, kuriems reikia prieigos prie Context duomenų, <code>useContext</code> leidžia paimti reikšmes iš  <code>Provider</code>. <code>useContext</code> priima Context objektą kaip argumentą ir grąžina esamas reikšmes, kurias teikia <code>Provider</code>.</li>
</ul>
<h3 id="pavyzdžiai-naudojant-usecontext">Pavyzdžiai naudojant <code>useContext</code></h3>
<ol>
<li>
<p><strong>Sukūrimas ir naudojimas</strong></p>
<pre><code>import { createContext, useContext, useState } from 'react';

const ThemeContext = createContext('light');

const ThemeProvider = ({ children }) =&gt; {
  const [theme, setTheme] = useState('light');

  return (
    &lt;ThemeContext.Provider value={{ theme, setTheme }}&gt;
      {children}
    &lt;/ThemeContext.Provider&gt;
  );
};

const ThemedButton = () =&gt; {
  const { theme, setTheme } = useContext(ThemeContext);

  return (
    &lt;button
      onClick={() =&gt; setTheme(theme === 'light' ? 'dark' : 'light')}
      style={{ background: theme === 'light' ? 'white' : 'black', color: theme === 'light' ? 'black' : 'white' }}
    &gt;
      Change Theme
    &lt;/button&gt;
  );
};
</code></pre>
</li>
<li>
<p><strong>Vartotojo prisijungimo pavyzdys</strong></p>
<pre><code>import { createContext, useContext, useState } from 'react';

const UserContext = createContext(null);

const UserProvider = ({ children }) =&gt; {
  const [user, setUser] = useState(null);

  const login = () =&gt; setUser("John Doe");
  const logout = () =&gt; setUser(null);

  return (
    &lt;UserContext.Provider value={{ user, setUser, login, logout }}&gt;
      {children}
    &lt;/UserContext.Provider&gt;
  );
};

const UserComponent = () =&gt; {
  const { user, login, logout } = useContext(UserContext);

  return (
    &lt;div&gt;
      {user ? (
        &lt;div&gt;
          Hello, {user}!
          &lt;button onClick={logout}&gt;Logout&lt;/button&gt;
        &lt;/div&gt;
      ) : (
        &lt;button onClick={login}&gt;Login&lt;/button&gt;
      )}
    &lt;/div&gt;
  );
};
</code></pre>
</li>
<li>
<p><strong>Notifications pavyzdys</strong></p>
</li>
</ol>
<p><strong>Sukuriamas context:</strong></p>
<pre><code>import { createContext, useContext, useState } from 'react';

const NotificationContext = createContext();

const NotificationProvider = ({ children }) =&gt; {
  const [notifications, setNotifications] = useState([]);

  const addNotification = (message) =&gt; {
    setNotifications(prev =&gt; [...prev, { id: prev.length + 1, text: message }]);
  };

  const removeNotification = (id) =&gt; {
    setNotifications(prev =&gt; prev.filter(notif =&gt; notif.id !== id));
  };

  return (
    &lt;NotificationContext.Provider value={{ notifications, addNotification, removeNotification }}&gt;
      {children}
    &lt;/NotificationContext.Provider&gt;
  );
};

export { NotificationProvider, NotificationContext };
</code></pre>
<p><strong>Komponentų naudojimas:</strong></p>
<pre><code>const Notifications = () =&gt; {
  const { notifications, removeNotification } = useContext(NotificationContext);

  return (
    &lt;div&gt;
      {notifications.map(notif =&gt; (
        &lt;div key={notif.id}&gt;
          {notif.text}
          &lt;button onClick={() =&gt; removeNotification(notif.id)}&gt;Close&lt;/button&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  );
};

const App = () =&gt; {
  const { addNotification } = useContext(NotificationContext);

  return (
    &lt;div&gt;
      &lt;button onClick={() =&gt; addNotification("New Notification: You have a new message!")}&gt;
        Add Notification
      &lt;/button&gt;
      &lt;Notifications /&gt;
    &lt;/div&gt;
  );
};
</code></pre>
<h3 id="alternatyva-zustand">Alternatyva <code>zustand</code></h3>
<p>Zustand yra lengvas ir intuityvus state įrankis React aplikacijoms, kuris suteikia paprastą API be sudėtingų boilerplate reikalavimų. Tai idealus sprendimas greitam ir lankstumą siūlančiam <em>global state managmenet</em> , ieškantiems efektyvesnės alternatyvos kaip <em>Redux</em>.</p>
<blockquote>
<p><a href="https://www.npmjs.com/package/zustand">https://www.npmjs.com/package/zustand</a></p>
</blockquote>
<pre><code>import { create } from 'zustand';

let nextNotificationId = 0;

// hook
const useNotificationStore = create(set =&gt; ({
  notifications: [],
  addNotification: (message) =&gt; set(state =&gt; ({
    notifications: [...state.notifications, { id: nextNotificationId++, text: message }]
  })),
  removeNotification: (id) =&gt; set(state =&gt; ({
    notifications: state.notifications.filter(notif =&gt; notif.id !== id)
  }))
}));

// component
const Notifications = () =&gt; {
  const { notifications, removeNotification } = useNotificationStore(state =&gt; ({
    notifications: state.notifications,
    removeNotification: state.removeNotification
  }));

  return (
    &lt;div&gt;
      {notifications.map(notif =&gt; (
        &lt;div key={notif.id}&gt;
          {notif.text}
          &lt;button onClick={() =&gt; removeNotification(notif.id)}&gt;Close&lt;/button&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  );
};

const App = () =&gt; {
  const addNotification = useNotificationStore(state =&gt; state.addNotification);

  return (
    &lt;div&gt;
      &lt;button onClick={() =&gt; addNotification("New Notification: You have a new message!")}&gt;
        Add Notification
      &lt;/button&gt;
      &lt;Notifications /&gt;
    &lt;/div&gt;
  );
};
</code></pre>
<p><a href="https://postimg.cc/9z15pmVD"><img src="https://i.postimg.cc/SNbSmRvf/Screenshot-2024-04-19-at-07-19-17.png" alt="Screenshot-2024-04-19-at-07-19-17.png"></a></p>
<blockquote>
<p>context isn’t really comparable to a global state management tool. you<br>
still have to handle all the state changes yourself - context just<br>
lets you just persist them to every consumer.</p>
<p>every context consumer also re-renders, which is a big diff between<br>
stuff like zustand or redux. global re-rendering is fine if it’s meant<br>
to be global (theme colors/dark mode, authentication) but otherwise<br>
it’s not great for performance.</p>
</blockquote>
<h2 id="užduotys">Užduotys</h2>
<h3 id="užduotis-home-service-aplikacija">1. Užduotis: Home service aplikacija</h3>
<p><a href="https://postimg.cc/8JbyGmbT"><img src="https://i.postimg.cc/cHpPQDgt/Screenshot-2024-04-19-at-07-40-42.png" alt="Screenshot-2024-04-19-at-07-40-42.png"></a></p>
<p>arba <a href="https://colorlib.com/wp/wp-content/uploads/sites/2/login-form-v2.jpg">https://colorlib.com/wp/wp-content/uploads/sites/2/login-form-v2.jpg</a></p>
<ol>
<li><strong>Login</strong>: Sukurti <code>/login</code> route, įgivendinti savo norimą dizainą ir pridėti validaciją inputų.</li>
<li><strong>Redirect</strong>: Suvedus inputus ir paspaudus <code>Login</code> mygtuką išsaugoti userio informaciją su <code>useContext</code> ir <code>localStorage</code> bei redirectint į pagrindinį <code>/</code> route</li>
<li><strong>Topbar komponentas</strong>: Atnaujinti komponento state kai asmuo yra prisijungęs <a href="https://postimg.cc/ftrjvqzq"><img src="https://i.postimg.cc/1X9CsbLS/4-5.png" alt="4-5.png"></a></li>
<li><strong>Register (optional)</strong>:  Įgivendinti <code>/register</code> route ir savo norimą dizainą</li>
</ol>
<blockquote>
<p>Inputų pavyzdžiai <a href="https://copy-paste-css.com/form-input-text">https://copy-paste-css.com/form-input-text</a></p>
</blockquote>

